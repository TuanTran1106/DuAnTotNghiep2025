<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Qu·∫£n l√Ω kho - ƒê·ªìng h·ªì</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrious/dist/qrious.min.js"></script>
    <style>
        body {
            background-color: #f4f6f9;
            font-family: 'Inter', sans-serif;
        }

        .card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .table-container {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }

        .product-img {
            width: 50px;
            height: auto;
            border-radius: 8px;
        }

        .btn-custom {
            border-radius: 8px;
            padding: 8px 16px;
            font-weight: 500;
        }

        .modal-content {
            border-radius: 12px;
            border: none;
        }

        .form-control, .form-select {
            border-radius: 8px;
            border: 1px solid #d1d5db;
            transition: border-color 0.3s;
        }

        .form-control:focus, .form-select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .pagination .page-link {
            border-radius: 8px;
            margin: 0 4px;
            color: #020202;
        }

        .pagination .page-item.active .page-link {
            background-color: #fffdfd;
            border-color: #9c9999;
        }

        .sao {
            color: red;
        }

        /* Loading Overlay */
        .loading-overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(253, 247, 247, 0.8);
            z-index: 10;
            justify-content: center;
            align-items: center;
            border-radius: 12px;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #252527;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .header-product {
            font-size: 14px;
            background-color: #fffdfd;
            border-color: black;
        }

        .header-product:hover {
            color: #9c9999;
        }

        .btn-lich-su {
            font-size: 14px;
            background-color: #fffdfd;
            border-color: black;
        }

        .btn-lich-su:hover {
            color: #9c9999;
        }
        .qr {
            font-size: 14px;
            background-color: #fffdfd;
            border-color: black;
        }

        .qr:hover {
            color: #9c9999;
        }

        .form-floating:hover > input:not(:focus):not(:placeholder-shown) + label,
        .form-floating:hover > input:not(:focus):placeholder-shown + label {
            transform: scale(0.85) translateY(-1.5rem);
            opacity: 0.85;
            transition: all 0.2s ease;
        }


    </style>
</head>
<body class="antialiased">
<div class="d-flex">
    <div class="flex-1 p-6">
        <div class="container mx-auto">

            <!--header-->
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-800">üì¶ Dashboard Qu·∫£n L√Ω Kho</h2>
                <div class="d-flex gap-2">
                    <button class="header-product"
                            data-bs-toggle="modal" data-bs-target="#sanPhamBanModal">
                        üõí Xem s·∫£n ph·∫©m ƒëang b√†y b√°n
                    </button>
                    <button class="btn-lich-su"
                            data-bs-toggle="modal" data-bs-target="#historyModal">
                        üìú L·ªãch s·ª≠
                    </button>
                </div>
            </div>

            <div class="row g-4 mb-6">
                <div class="col-md-3">
                    <div class="card bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4">
                        <h5 class="card-title text-sm font-medium">T·ªïng s·∫£n ph·∫©m</h5>
                        <p class="card-text text-2xl font-bold" th:text="${totalProduct}"></p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-gradient-to-r from-green-500 to-green-600 text-white p-4">
                        <h5 class="card-title text-sm font-medium">T·ªïng t·ªìn kho</h5>
                        <p class="card-text text-2xl font-bold" th:text="${totalProductInSock}"></p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-gradient-to-r from-yellow-500 to-yellow-600 text-white p-4">
                        <h5 class="card-title text-sm font-medium">Gi√° tr·ªã t·ªìn kho</h5>
                        <p class="card-text text-2xl font-bold" th:text="${totalPriceInSock}"></p>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card bg-gradient-to-r from-red-500 to-red-600 text-white p-4">
                        <h5 class="card-title text-sm font-medium">S·∫Øp h·∫øt h√†ng</h5>
                        <p class="card-text text-2xl font-bold" th:text="${totalProductIsOut}"></p>
                    </div>
                </div>
            </div>

            <div class="table-container mb-6">
                <h3 class="text-lg font-semibold mb-4">üì¶ Danh s√°ch t·ªìn kho</h3>
                <form class="row g-3 align-items-end">
                    <div class="col-md-3">
                        <label class="form-label text-sm font-medium">T·ª´ kh√≥a</label>
                        <input style="font-size: 14px" type="text" class="form-control" name="keyword"
                               placeholder="T√™n s·∫£n ph·∫©m...">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-sm font-medium">Th∆∞∆°ng hi·ªáu</label>
                        <select style="font-size: 14px" class="form-select" name="thuongHieu">
                            <option style="font-size: 14px" value="">-- T·∫•t c·∫£ --</option>
                            <option style="font-size: 14px" th:each="brand : ${listBrand}" th:value="${brand.id}"
                                    th:text="${brand.tenThuongHieu}"></option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-sm font-medium">Danh m·ª•c</label>
                        <select style="font-size: 14px" class="form-select" name="danhMuc">
                            <option style="font-size: 14px" value="">-- T·∫•t c·∫£ --</option>
                            <option style="font-size: 14px" th:each="dm : ${listCategory}" th:value="${dm.id}"
                                    th:text="${dm.tenDanhMuc}"></option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label text-sm font-medium">Tr·∫°ng th√°i</label>
                        <select style="font-size: 14px" class="form-select" name="status">
                            <option style="font-size: 14px" value="">-- T·∫•t c·∫£ --</option>
                            <option style="font-size: 14px" value="1">C√≤n h√†ng</option>
                            <option value="0">H·∫øt h√†ng</option>
                        </select>
                    </div>
                    <div class="col-md-3 d-flex gap-2">
                        <button style="font-size: 14px; background-color:#fffdfd;border-color: black"
                                class="btn btn-custom btn-filter" type="submit">L·ªçc
                        </button>
                        <a style="font-size: 14px" href="/quan-ly/kho"
                           class="btn btn-custom btn-outline-secondary btn-reset">Reset</a>
                    </div>
                </form>
            </div>

            <!-- ds t·ªìn kho-->
            <div class="table-container" id="table-container">
                <div class="loading-overlay" id="loading-overlay">
                    <div class="loading-spinner"></div>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover align-middle text-center">
                        <thead class="bg-gray-100">
                        <tr>
                            <th class="py-3">#</th>
                            <th>T√™n s·∫£n ph·∫©m</th>
                            <th>M√†u s·∫Øc</th>
                            <th>K√≠ch th∆∞·ªõc</th>
                            <th>Ch·∫•t li·ªáu</th>
                            <th>Gi√° b√°n</th>
                            <th>S·ªë l∆∞·ª£ng t·ªìn</th>
                            <th>Th∆∞∆°ng hi·ªáu</th>
                            <th>Danh m·ª•c</th>
                            <th>Thao t√°c</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="sock,start : ${listInSock}" th:class="${sock.soLuong <= 10} ? 'bg-red-50'">
                            <td th:text="${start.index + 1}"></td>
                            <td th:text="${sock.tenSanPham}"></td>
                            <td th:text="${sock.mauSac}"></td>
                            <td th:text="${sock.kichThuoc}"></td>
                            <td th:text="${sock.chatLieu}"></td>
                            <td th:text="${#numbers.formatDecimal(sock.giaBan, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"></td>
                            <td class="font-bold" th:class="${sock.soLuong <= 10} ? 'text-red-600' : 'text-gray-800'"
                                th:text="${sock.soLuong}"></td>
                            <td th:text="${sock.tenThuongHieu}"></td>
                            <td th:text="${sock.tenDanhMuc}"></td>
                            <td class="d-flex gap-2 justify-content-center">
                                <a class="btn btn-custom btn-sm btn-success btn-nhap" th:attr="data-id=${sock.id}"
                                   data-bs-toggle="modal" data-bs-target="#enter">+ Nh·∫≠p</a>
                                <a class="btn btn-custom btn-sm btn-danger btn-xuat" th:attr="data-id=${sock.id}"
                                   data-bs-toggle="modal" data-bs-target="#export">- Xu·∫•t</a>
                                <a class="btn btn-custom btn-sm btn-warning btn-sua" th:attr="data-id=${sock.id}"
                                   data-bs-toggle="modal" data-bs-target="#editModal">S·ª≠a</a>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                </div>

                <!--ph√¢n trang-->
                <nav class="mt-4">
                    <ul class="pagination justify-content-center">
                        <li class="page-item" th:classappend="${startPage == 0} ? 'disabled'">
                            <a class="page-link" th:href="@{/quan-ly/kho(page=${startPage - 1})}">¬´</a>
                        </li>
                        <li class="page-item" th:each="i : ${#numbers.sequence(0, totalPage - 1)}"
                            th:classappend="${i == startPage} ? 'active'">
                            <a class="page-link" th:href="@{/quan-ly/kho(page=${i})}" th:text="${i + 1}">1</a>
                        </li>
                        <li class="page-item" th:classappend="${startPage == totalPage - 1} ? 'disabled'">
                            <a class="page-link" th:href="@{/quan-ly/kho(page=${startPage + 1})}">¬ª</a>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- modal nhap -->
            <div class="modal fade" id="enter" tabindex="-1">
                <div class="modal-dialog">
                    <form method="post" th:action="@{/quan-ly/kho/nhap}" th:object="${form}" id="formNhap">
                        <input type="hidden" name="id" id="nhap-id">
                        <div class="modal-content border-0 rounded shadow-sm">
                            <div class="modal-header bg-white border-bottom">
                                <h5 class="modal-title text-dark fw-semibold">üì¶ Nh·∫≠p h√†ng</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                            </div>
                            <div class="modal-body">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="soLuongNhap" name="soLuong"
                                           placeholder="S·ªë l∆∞·ª£ng nh·∫≠p" min="1">
                                    <label style="font-size: 14px" for="soLuongNhap">S·ªë l∆∞·ª£ng nh·∫≠p <span class="text-danger">*</span></label>
                                    <div class="invalid-feedback" id="soLuongNhapError"></div>
                                </div>
                                <div class="form-floating" style="padding-top: 10px">
                                    <input type="text" class="form-control" id="ghiChu" name="ghiChuNhap"
                                           placeholder="Ghi ch√∫" >
                                    <label style="font-size: 14px" for="soLuongXuat">Ghi ch√∫<span class="text-danger">*</span></label>
                                </div>
                            </div>
                            <div class="modal-footer bg-light border-top">
                                <button type="submit" class="btn btn-primary">L∆∞u</button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- modal xuat -->
            <div class="modal fade" id="export" tabindex="-1">
                <div class="modal-dialog">
                    <form method="post" th:action="@{/quan-ly/kho/xuat}" id="formXuat">
                        <input type="hidden" name="id" id="xuat-id">
                        <div class="modal-content border-0 rounded shadow-sm">
                            <div class="modal-header bg-white border-bottom">
                                <h5 class="modal-title text-dark fw-semibold">üì§ Xu·∫•t h√†ng</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                            </div>
                            <div class="modal-body">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="soLuongXuat" name="soLuong"
                                           placeholder="S·ªë l∆∞·ª£ng xu·∫•t" min="1" >
                                    <label style="font-size: 14px" for="soLuongXuat">S·ªë l∆∞·ª£ng xu·∫•t <span class="text-danger">*</span></label>
                                    <div class="invalid-feedback" id="soLuongXuatError"></div>
                                </div>
                                <div class="form-floating" style="padding-top: 10px">
                                    <input type="text" class="form-control" id="ghiChuXuat" name="ghiChuXuat"
                                           placeholder="Ghi ch√∫" >
                                    <label style="font-size: 14px" for="soLuongXuat">Ghi ch√∫<span class="text-danger">*</span></label>
                                </div>
                            </div>
                            <div class="modal-footer bg-light border-top">
                                <button type="submit" class="btn btn-primary">L∆∞u</button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- modal update -->
            <div class="modal fade" id="editModal" tabindex="-1">
                <div class="modal-dialog">
                    <form method="post" th:action="@{/quan-ly/kho/sua}" id="formSua">
                        <input type="hidden" name="id" id="sua-id">
                        <div class="modal-content border-0 rounded shadow-sm">
                            <div class="modal-header bg-white border-bottom">
                                <h5 class="modal-title text-dark fw-semibold">üìù C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                            </div>
                            <div class="modal-body">
                                <div class="form-floating">
                                    <input type="text" class="form-control" id="soLuongMoi" name="soLuong"
                                           placeholder="S·ªë l∆∞·ª£ng m·ªõi" min="0">
                                    <label style="font-size: 14px" for="soLuongMoi">S·ªë l∆∞·ª£ng m·ªõi <span class="text-danger">*</span></label>
                                    <div class="invalid-feedback" id="soLuongSuaError"></div>
                                </div>
                                <div class="form-floating" style="padding-top: 10px">
                                    <input type="text" class="form-control" id="ghiChuUpdate" name="ghiChuUpdate"
                                           placeholder="Ghi ch√∫" >
                                    <label style="font-size: 14px" for="soLuongXuat">Ghi ch√∫<span class="text-danger">*</span></label>
                                </div>
                            </div>
                            <div class="modal-footer bg-light border-top">
                                <button type="submit" class="btn btn-primary">L∆∞u</button>
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">H·ªßy</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>

            <!-- modal lich su -->
            <div class="modal fade" id="historyModal" tabindex="-1">
                <div class="modal-dialog modal-lg">
                    <input type="hidden" name="id" id="lich-su-id">
                    <div class="modal-content border-0 rounded shadow-sm">
                        <div class="modal-header bg-white border-bottom">
                            <h5 class="modal-title text-dark fw-semibold">üìú L·ªãch s·ª≠ nh·∫≠p/xu·∫•t kho</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
                        </div>
                        <div class="modal-body">
                            <div class="table-responsive">
                                <table class="table table-bordered table-hover text-sm text-center align-middle">
                                    <thead class="table-light">
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col">Ng√†y th·ª±c hi·ªán</th>
                                        <th scope="col">Ng∆∞·ªùi thao t√°c</th>
                                        <th scope="col">Lo·∫°i</th>
                                        <th scope="col">S·ªë l∆∞·ª£ng</th>
                                        <th scope="col">Ghi ch√∫</th>
                                    </tr>
                                    </thead>
                                    <tbody id="historyBody">

                                    <tr>
                                        <td colspan="6" class="text-muted">Ch∆∞a c√≥ d·ªØ li·ªáu</td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="modal-footer bg-light border-top">
                            <button type="button" class="btn btn-outline-dark btn-sm" data-bs-dismiss="modal">ƒê√≥ng
                            </button>
                        </div>
                    </div>
                </div>
            </div>


            <!--modal s·∫£n ph·∫©m ƒëagn b√†y b√°n-->
            <div class="modal fade" id="sanPhamBanModal" tabindex="-1">
                <div class="modal-dialog modal-xl modal-dialog-scrollable">
                    <div class="modal-content border-0 rounded-3 shadow-sm">
                        <div class="modal-header bg-white border-bottom">
                            <h5 class="modal-title fw-semibold text-dark">üõí Danh s√°ch s·∫£n ph·∫©m ƒëang b√†y b√°n</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>

                        <div class="modal-body p-4">
                            <div class="table-responsive">
                                <table class="table table-bordered align-middle table-hover text-sm">
                                    <thead class="table-light text-center">
                                    <tr>
                                        <th scope="col">#</th>
                                        <th scope="col" class="text-start">T√™n s·∫£n ph·∫©m</th>
                                        <th scope="col">H√¨nh ·∫£nh</th>
                                        <th scope="col">Gi√° b√°n</th>
                                        <th scope="col">Th∆∞∆°ng hi·ªáu</th>
                                        <th scope="col">Danh m·ª•c</th>
                                        <th scope="col">Tr·∫°ng th√°i</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr th:each="product, iStat : ${listProductDangBan}">
                                        <td th:text="${iStat.index + 1}" class="text-center"></td>
                                        <td th:text="${product.tenSanPham}"
                                            class="text-start fw-medium text-gray-800"></td>
                                        <td class="text-center">
                                            <img th:src="@{${product.hinhAnh}}" alt="·∫¢nh s·∫£n ph·∫©m" class="rounded"
                                                 style="width: 60px; height: auto;">
                                        </td>
                                        <td th:text="${#numbers.formatDecimal(product.giaBan, 0, 'COMMA', 0, 'POINT')} + ' ‚Ç´'"
                                            class="text-end text-dark"></td>
                                        <td th:text="${product.tenThuongHieu}" class="text-center text-muted"></td>
                                        <td th:text="${product.tenDanhMuc}" class="text-center text-muted"></td>
                                        <td class="text-center">
                                            <span th:if="${product.trangThai}"
                                                  class="badge bg-success-subtle text-success">ƒêang b√°n</span>
                                            <span th:if="${!product.trangThai}"
                                                  class="badge bg-secondary-subtle text-secondary">Ng·ª´ng b√°n</span>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="modal-footer bg-light border-top">
                            <button type="button" class="btn btn-outline-dark btn-sm" data-bs-dismiss="modal">ƒê√≥ng
                            </button>
                        </div>
                    </div>
                </div>
            </div>


            <!-- modal QR -->
            <div class="modal fade" id="qrModal" tabindex="-1">
                <div class="modal-dialog">
                    <div class="modal-content border-0 rounded shadow-sm">
                        <div class="modal-header">
                            <h5 class="modal-title">üì∑ M√£ QR s·∫£n ph·∫©m</h5>
                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <div class="modal-body text-center">
                            <input type="text" id="qrText" class="form-control mb-3" placeholder="Nh·∫≠p m√£ s·∫£n ph·∫©m ho·∫∑c t√™n...">
                            <canvas id="qrCanvas"></canvas>
                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {

        // m·ªü form
        document.querySelectorAll(".btn-nhap").forEach(btn => {
            btn.addEventListener("click", function () {
                const id = btn.getAttribute("data-id");
                document.getElementById("nhap-id").value = id;
            });
        });

        document.querySelectorAll(".btn-xuat").forEach(btn => {
            btn.addEventListener("click", function () {
                const id = btn.getAttribute("data-id");
                document.getElementById("xuat-id").value = id;
            });
        });

        document.querySelectorAll(".btn-sua").forEach(btn => {
            btn.addEventListener("click", function () {
                const id = btn.getAttribute("data-id");
                document.getElementById("sua-id").value = id;
            });
        });
        document.querySelectorAll(".btn-lich-su").forEach(btn => {
            btn.addEventListener("click", function () {
                const id = btn.getAttribute("data-id");
                document.getElementById("lich-su-id").value = id;
            });
        });

        // loading khi click button
        document.querySelector(".btn-reset").addEventListener("click", function (e) {
            e.preventDefault();
            const loadingOverlay = document.getElementById("loading-overlay");
            loadingOverlay.style.display = "flex";

            setTimeout(() => {
                window.location.href = "/quan-ly/kho";
            }, 700);
        });

        document.querySelector(".btn-filter").addEventListener("click", function (e) {
            e.preventDefault();
            const loadingOverlay = document.getElementById("loading-overlay");
            loadingOverlay.style.display = "flex";

            const form = e.target.closest("form");
            setTimeout(() => {
                form.submit();
            }, 700);
        });


        const modalMap = {
            'enter': 'enter',
            'export': 'export',
            'edit': 'editModal'
        };
        const modalError = /*[[${modalError}]]*/ '';
        if (modalError) {
            const modalId = modalMap[modalError];
            const modal = new bootstrap.Modal(document.getElementById(modalId));
            modal.show();
        }



        // th√¥ng b√°o l·ªói khi update , xu·∫•t , nh·∫≠p
        const formNhap = document.getElementById('formNhap');
        const soLuongNhap = document.getElementById('soLuongNhap');
        const soLuongNhapError = document.getElementById('soLuongNhapError');

        const formXuat = document.getElementById('formXuat');
        const soLuongXuat = document.getElementById('soLuongXuat');
        const soLuongXuatError = document.getElementById('soLuongXuatError');

        const formSua = document.getElementById('formSua');
        const soLuongMoi = document.getElementById('soLuongMoi');
        const soLuongSuaError = document.getElementById('soLuongSuaError');

        function validateNumber(input, errorElem, min = 1) {
            const value = input.value.trim();

            if (!/^\d+$/.test(value)) {
                errorElem.textContent = 'Vui l√≤ng nh·∫≠p s·ªë nguy√™n h·ª£p l·ªá.';
                input.classList.add('is-invalid');
                return false;
            } else if (parseInt(value, 10) < min) {
                errorElem.textContent = `S·ªë l∆∞·ª£ng ph·∫£i l·ªõn h∆°n ho·∫∑c b·∫±ng ${min}.`;
                input.classList.add('is-invalid');
                return false;
            } else {
                errorElem.textContent = '';
                input.classList.remove('is-invalid');
                return true;
            }
        }

        formNhap.addEventListener('submit', e => {
            if (!validateNumber(soLuongNhap, soLuongNhapError, 1)) {
                e.preventDefault();
            }
        });

        formXuat.addEventListener('submit', e => {
            if (!validateNumber(soLuongXuat, soLuongXuatError, 1)) {
                e.preventDefault();
            }
        });

        formSua.addEventListener('submit', e => {
            if (!validateNumber(soLuongMoi, soLuongSuaError, 0)) {
                e.preventDefault();
            }
        });

        [ {input: soLuongNhap, error: soLuongNhapError, min: 1},
            {input: soLuongXuat, error: soLuongXuatError, min: 1},
            {input: soLuongMoi, error: soLuongSuaError, min: 0} ]
            .forEach(({input, error, min}) => {
                input.addEventListener('input', () => {
                    validateNumber(input, error, min);
                });
            });

    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>